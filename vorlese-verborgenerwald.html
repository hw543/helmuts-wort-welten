<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Der verborgene Wald ‚Äì Vorleseabenteuer</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: "Georgia", serif;
            line-height: 1.8;
            background: linear-gradient(135deg, #FFE5B4 0%, #FFB6C1 50%, #98FB98 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            background: linear-gradient(135deg, #FFF8DC 0%, #F0F8FF 100%);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 3px solid #FFD700;
        }
        h1 {
            color: #FF6347;
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(255, 105, 180, 0.3);
        }
        .author {
            text-align: center;
            color: #9370DB;
            font-style: italic;
            font-size: 1.2em;
            margin-bottom: 30px;
        }
        .controls {
            position: sticky;
            top: 10px;
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #FFE4E1 0%, #E6E6FA 100%);
            border-radius: 15px;
            border: 2px solid #FFB6C1;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(255, 182, 193, 0.3);
        }
        .language-navigation {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .btn-lang {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #9370DB, #8A2BE2);
            color: white;
        }
        .btn-lang.active {
            border: 2px solid #FFD700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #ffffff;
            margin: 0 5px;
        }
        .btn-play { background: linear-gradient(135deg, #32CD32, #228B22); }
        .btn-continue { background: linear-gradient(135deg, #4F8F56, #356C3F); }
        .btn-stop { background: linear-gradient(135deg, #FF6347, #FF4500); }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.25);
        }
        .story-text {
            font-size: 1.1em;
            line-height: 1.8;
            color: #2F4F4F;
            text-align: justify;
            background: linear-gradient(135deg, #FFFAF0 0%, #FFF8DC 100%);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #DDA0DD;
            box-shadow: 0 5px 15px rgba(221, 160, 221, 0.2);
        }
        .word {
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 1px 2px;
            border-radius: 3px;
        }
        .word:hover { background-color: #E7F9E7; }
        .word-highlight {
            background-color: #4169E1;
            color: white;
            padding: 2px 4px;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(65, 105, 225, 0.3);
        }
        .language-content.hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Der verborgene Wald</h1>
        <p class="author">Ein magisches Abenteuer</p>
        <div class="controls">
            <div class="language-navigation">
                <button class="btn-lang active" onclick="switchLanguage('de', event)">üá©üá™ Deutsch</button>
                <button class="btn-lang" onclick="switchLanguage('en', event)">üá¨üáß English</button>
            </div>
            <button class="btn btn-play" id="btn-play" onclick="startReading()">‚ñ∂Ô∏è Vorlesen</button>
            <button class="btn btn-continue" id="btn-continue" onclick="continueReading()">‚è© Weiterlesen</button>
            <button class="btn btn-stop" id="btn-stop" onclick="stopReading()">‚èπÔ∏è Stop</button>
        </div>
        <!-- Deutscher Text -->
        <div class="story-text language-content" id="de-content">
            <p>Marie stand am Rand des Waldes und blickte zwischen die hohen B√§ume. Ihr Herz schlug vor Aufregung und ein wenig Angst. Sie hatte die Geschichten geh√∂rt, die sich die Kinder in ihrem Dorf erz√§hlten ‚Äì von einem magischen Wald, der sich nur wenigen zeigte. Heute wollte sie herausfinden, ob diese Geschichten wahr waren.</p>
            <p>Die B√§ume ragten wie W√§chter in den Himmel, ihre Kronen so dicht, dass kaum Sonnenlicht den Waldboden erreichte. Marie fasste all ihren Mut zusammen und trat zwischen die ersten √Ñste.</p>
            <p>Pl√∂tzlich h√∂rte sie ein leises Summen, das durch die Luft schwebte. Es klang wie eine Melodie, die sie noch nie zuvor geh√∂rt hatte.</p>
            <p>Je tiefer sie in den Wald vordrang, desto fremder wurde alles um sie herum. Die Bl√§tter schimmerten in Farben, die sie nicht benennen konnte, und die Luft war erf√ºllt von einem s√º√üen Duft, der sie an M√§rchen und Abenteuer erinnerte. Marie sp√ºrte, dass sie einem gro√üen Geheimnis auf der Spur war.</p>
        </div>
        <!-- Englischer Text (identischer Inhalt f√ºr Platzhalter) -->
        <div class="story-text language-content hidden" id="en-content">
            <p>Marie stood at the edge of the forest and looked between the tall trees. Her heart beat with excitement and a little fear. She had heard the stories that the children in her village told each other ‚Äì of a magical forest that showed itself only to a few. Today she wanted to find out if these stories were true.</p>
            <p>The trees towered like guardians into the sky, their crowns so dense that hardly any sunlight reached the forest floor. Marie gathered all her courage and stepped between the first branches.</p>
            <p>Suddenly she heard a soft humming floating through the air. It sounded like a melody she had never heard before.</p>
            <p>The deeper she ventured into the forest, the stranger everything around her became. The leaves shimmered in colors she couldn't name, and the air was filled with a sweet scent that reminded her of fairy tales and adventures. Marie felt that she was on the trail of a great secret.</p>
        </div>
    </div>
    <script>
        let currentSpeech = null;
        let currentLanguage = 'de';
        let currentWordIndex = 0;
        const allWords = { de: [], en: [] };
        let lastHighlightedWord = null;

        function initializeWords() {
            ['de', 'en'].forEach(lang => {
                const container = document.getElementById(`${lang}-content`);
                const paragraphs = container.querySelectorAll('p');
                let wordCounter = 0;
                allWords[lang] = [];
                paragraphs.forEach(paragraph => {
                    const words = paragraph.textContent.trim().split(/\s+/);
                    let html = '';
                    words.forEach(word => {
                        const safeWord = word.replace(/</g, '&lt;').replace(/>/g, '&gt;');
                        html += `<span class="word" data-index="${wordCounter}" onclick="startFromWord(${wordCounter})">${safeWord}</span> `;
                        allWords[lang].push(word);
                        wordCounter++;
                    });
                    paragraph.innerHTML = html.trim();
                });
            });
        }

        function highlightWord(index) {
            if (lastHighlightedWord) lastHighlightedWord.classList.remove('word-highlight');
            const element = document.querySelector(`#${currentLanguage}-content .word[data-index="${index}"]`);
            if (element) {
                element.classList.add('word-highlight');
                lastHighlightedWord = element;
                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function startReading() {
            currentWordIndex = 0;
            if (currentSpeech) speechSynthesis.cancel();
            continueReading();
        }

        function continueReading() {
            if (currentSpeech) speechSynthesis.cancel();
            const words = allWords[currentLanguage];
            if (words && words.length > currentWordIndex) {
                const remainingText = words.slice(currentWordIndex).join(' ');
                currentSpeech = new SpeechSynthesisUtterance(remainingText);
                currentSpeech.rate = 1.0;
                currentSpeech.lang = currentLanguage === 'de' ? 'de-DE' : 'en-US';
                let localIndex = currentWordIndex;
                currentSpeech.onboundary = function(event) {
                    if (event.name === 'word') {
                        highlightWord(localIndex);
                        localIndex++;
                        currentWordIndex = localIndex;
                    }
                };
                currentSpeech.onend = function() {};
                speechSynthesis.speak(currentSpeech);
            }
        }

        function startFromWord(index) {
            currentWordIndex = index;
            if (currentSpeech) speechSynthesis.cancel();
            continueReading();
        }

        function stopReading() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
            }
        }

        function switchLanguage(lang, event) {
            stopReading();
            currentLanguage = lang;
            currentWordIndex = 0;
            document.querySelectorAll('.language-content').forEach(elem => elem.classList.add('hidden'));
            document.getElementById(`${lang}-content`).classList.remove('hidden');
            const labels = {
                de: { play: 'Vorlesen', cont: 'Weiterlesen', stop: 'Stop' },
                en: { play: 'Read', cont: 'Continue', stop: 'Stop' }
            };
            document.getElementById('btn-play').innerHTML = `‚ñ∂Ô∏è ${labels[lang].play}`;
            document.getElementById('btn-continue').innerHTML = `‚è© ${labels[lang].cont}`;
            document.getElementById('btn-stop').innerHTML = `‚èπÔ∏è ${labels[lang].stop}`;
            document.querySelectorAll('.btn-lang').forEach(btn => btn.classList.remove('active'));
            if (event && event.target) event.target.classList.add('active');
            const topElem = document.getElementById(`${lang}-content`);
            if (topElem) topElem.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        document.addEventListener('DOMContentLoaded', () => {
            initializeWords();
            switchLanguage('de');
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mondstein â€“ Vorleseabenteuer</title>
    <style>
        /* Grundlegendes Seitenlayout */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Georgia', serif;
            line-height: 1.8;
            color: #2c1810;
            background: linear-gradient(135deg, #FFEFEF 0%, #FFD4C2 50%, #FFCFCF 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #FFF8F0;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            /*
             * Entferne das overflow: hidden; damit Sticky-Elemente wie die
             * Steuerungsleiste beim Scrollen sichtbar bleiben. Wenn overflow
             * auf hidden gesetzt ist, endet der Sichtbereich der Containerbox
             * und stickyâ€‘Positionen lÃ¶sen sich auf, sobald der Container aus
             * dem Viewport verschwindet. Ohne overflow bleibt die Leiste am
             * oberen Rand kleben, bis der Leser das Ende des Inhalts erreicht.
             */
            overflow: visible;
        }
        .header {
            background: linear-gradient(135deg, #7EC850, #3FA34D);
            color: #FFF8F0;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.4em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            font-style: italic;
        }
        .controls {
            background: #FFF8F8;
            padding: 20px;
            border-bottom: 3px solid #7EC850;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .language-navigation {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        .btn-lang {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #7EC850, #3FA34D);
            color: white;
        }
        .btn-lang.active {
            border: 2px solid #FFD700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        .btn-lang:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }
        .control-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            color: white;
        }
        .btn-play {
            background: linear-gradient(135deg, #EA4335, #D93025);
        }
        .btn-continue {
            background: linear-gradient(135deg, #34A853, #0F9D58);
        }
        .btn-stop {
            background: linear-gradient(135deg, #F9AB00, #FBBC05);
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .content {
            padding: 30px;
            font-size: 1.1em;
            line-height: 1.8;
        }
        .book-title {
            color: #5B8C5A;
            font-size: 2em;
            margin-bottom: 10px;
            text-align: center;
            border-bottom: 2px solid #7EC850;
            padding-bottom: 10px;
        }
        .chapter-title {
            color: #3F6B3F;
            font-size: 1.5em;
            margin: 25px 0 15px;
            text-align: center;
            font-style: italic;
        }
        .text-content {
            text-align: justify;
            margin-bottom: 30px;
        }
        .word {
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 1px 2px;
            border-radius: 3px;
        }
        .word:hover {
            background-color: #E7F9E7;
        }
        .word-highlight {
            background-color: #4169E1;
            color: white;
            padding: 2px 4px;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(65, 105, 225, 0.3);
        }
        /* Versteckt Elemente wie die englische Fassung bis zur Aktivierung */
        .hidden {
            display: none;
        }
        @media (max-width: 600px) {
            .control-buttons {
                gap: 10px;
            }
            .btn {
                min-width: 100px;
                font-size: 0.9em;
                padding: 10px 16px;
            }
            .content {
                padding: 20px;
                font-size: 1em;
            }
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MondsteinÂ â€“ Das Geheimnis des leuchtenden Fragments</h1>
            <p>Vorlesen und Mitlesen leicht gemachtÂ â€“ tauchen Sie ein in ein neues Abenteuer</p>
        </div>
        <div class="controls">
            <!-- Sprachumschalter -->
            <div class="language-navigation">
                <button class="btn-lang active" onclick="switchLanguage('de', event)">ğŸ‡©ğŸ‡ª Deutsch</button>
                <button class="btn-lang" onclick="switchLanguage('en', event)">ğŸ‡¬ğŸ‡§ English</button>
            </div>
            <!-- Funktionsbuttons; die Beschriftung wird je nach Sprache aktualisiert -->
            <div class="control-buttons">
                <button class="btn btn-play" id="btn-play" onclick="startReading()">ğŸ”´Â Vorlesen</button>
                <button class="btn btn-continue" id="btn-continue" onclick="continueReading()">â–¶ï¸Â Weiterlesen</button>
                <button class="btn btn-stop" id="btn-stop" onclick="stopReading()">â¹ï¸Â Stop</button>
            </div>
        </div>
        <div class="content">
            <div class="book-title">BandÂ 1: Das Geheimnis des leuchtenden Fragments</div>
            <div class="chapter-title">KapitelÂ 1: Die Entdeckung im Park</div>
            <!-- Deutsche Fassung -->
            <div id="de-content" class="language-content">
                <div class="text-content" id="de-textContent">
                    <p>
                        An einem sonnigen Nachmittag spielten Leni, Finn und Arvid im Park ihres kleinen Dorfes. Es war ein ganz normaler Tag, an dem die VÃ¶gel sangen und eine leichte Brise durch die BÃ¤ume wehte. Die drei Freunde hatten sich am groÃŸen Eichenbaum getroffen, ihrem Lieblingsplatz, an dem sie oft ihre Abenteuer planten. Leni, die immer neugierig war, entdeckte etwas Seltsames im GebÃ¼sch.Â Â«SchautÂ mal, wasÂ istÂ das?Â», rief sie und deutete auf ein schwaches, goldenes Licht, das zwischen den BlÃ¤ttern hindurchschimmerte. Finn und Arvid kamen neugierig nÃ¤her, und gemeinsam schoben sie die Zweige beiseite. Dort, halb vergraben im weichen Waldboden, lag ein seltsames, leuchtendes Fragment. Es war etwa so groÃŸ wie Lenis HandflÃ¤che und hatte eine ungewÃ¶hnliche Form, die an einen Stern erinnerte. Die OberflÃ¤che des Fragments war mit leuchtenden Symbolen bedeckt, die in einem sanften, goldenen Licht schimmerten.Â Â«DasÂ istÂ ja unglaublichÂ», flÃ¼sterte Finn ehrfÃ¼rchtig.
                    </p>
                    <p>
                        Arvid, der immer mutig war, hob das Fragment vorsichtig auf. Sofort durchflutete sie ein warmes, beruhigendes GefÃ¼hl, und die Symbole auf dem Fragment begannen heller zu leuchten.Â Â«Es fÃ¼hlt sich magisch anÂ», sagte Arvid mit groÃŸen Augen. Leni, die immer nachdenklich war, betrachtete das Fragment genau.Â Â«Ich glaube, dasÂ ist etwas BesonderesÂ», sagte sie.Â Â«Vielleicht ist es ein Teil von etwas GrÃ¶ÃŸerem.Â» Die drei Freunde setzten sich unter den groÃŸen Eichenbaum und betrachteten das Fragment ausgiebig. Sie bemerkten, dass die Symbole sich zu bewegen schienen und Muster bildeten, die sie nicht sofort verstehen konnten.Â Â«Vielleicht ist es eine Art KarteÂ», mutmaÃŸte Finn.Â Â«Seht ihr, diese Linien kÃ¶nnten Wege sein, und diese Punkte besondere Orte markieren.Â» Leni nickte.Â Â«Ihr habt recht. Es sieht wirklich aus wie eine Karte. Aber wohin fÃ¼hrt sie uns?Â» Arvid sprang auf.Â Â«Lasst uns herausfinden, was es ist! Vielleicht fÃ¼hrt es uns zu einem Schatz oder einem geheimnisvollen Ort.Â» Die drei Freunde waren sich einig: Sie mussten mehr Ã¼ber das leuchtende Fragment herausfinden und beschlossen, am nÃ¤chsten Tag in die alte Bibliothek des Dorfes zu gehen.
                    </p>
                    <p>
                        Als der Morgen endlich anbrach, waren die drei Freunde bereits wach und bereit fÃ¼r ihr Abenteuer. In der Bibliothek erzÃ¤hlten sie der freundlichen FrauÂ Meier von ihrer Entdeckung. Die Bibliothekarin fÃ¼hrte sie zu einem alten, ledergebundenen Buch und schlug ein Kapitel Ã¼ber eine Legende der Lichtsteine auf. Es hieÃŸ, dass diese Steine vor langer Zeit von einem weisen Zauberer erschaffen worden waren, um die Welt vor einer dunklen Macht zu schÃ¼tzen, und dass sie in mehrere Fragmente zerbrochen und verborgen worden waren.Â Â«Unser Fragment kÃ¶nnte ein Teil dieser Lichtsteine seinÂ», flÃ¼sterte Finn. Leni nickte nachdenklich.Â Â«Das wÃ¼rde erklÃ¤ren, warum es so magisch wirktÂ», sagte sie. Die drei Freunde beschlossen, dem RÃ¤tsel zu folgen und sich auf die Suche nach den Ã¼brigen Fragmenten zu machen.
                    </p>
                </div>
            </div>
            <!-- Englische Fassung (versteckt, bis sie aktiviert wird) -->
            <div id="en-content" class="language-content hidden">
                <div class="text-content" id="en-textContent">
                    <p>
                        On a sunny afternoon, Leni, Finn and Arvid were playing in the park of their small village. It was an ordinary day, with birds singing and a gentle breeze blowing through the trees. The three friends had met under the great oak tree, their favourite spot where they often planned their adventures. Leni, always curious, discovered something strange in the bushes. â€œLook, whatâ€™s that?â€ she cried, pointing to a faint golden light shining through the leaves. Finn and Arvid came closer, and together they pushed the branches aside. There, half buried in the soft forest floor, lay a strange, glowing fragment. It was about the size of Leniâ€™s palm and had an unusual shape that reminded them of a star. The surface of the fragment was covered with luminous symbols shimmering in a soft golden light. â€œThis is incredible,â€ whispered Finn reverently.
                    </p>
                    <p>
                        Arvid, who was always brave, carefully picked up the fragment. Immediately a warm, calming feeling flooded them, and the symbols on the fragment began to glow more brightly. â€œIt feels magical,â€ said Arvid, eyes wide. Leni, ever thoughtful, examined the fragment carefully. â€œI think this is something special,â€ she said. â€œMaybe itâ€™s part of something bigger.â€ The three friends sat under the great oak tree and studied the fragment closely. They noticed that the symbols seemed to move and form patterns they couldnâ€™t immediately understand. â€œMaybe itâ€™s some kind of map,â€ mused Finn. â€œSee, these lines could be paths, and these dots could mark special places.â€ Leni nodded. â€œYouâ€™re right. It really looks like a map. But where does it lead us?â€ Arvid jumped up. â€œLetâ€™s find out what it is! Maybe itâ€™ll lead us to a treasure or a mysterious place.â€ The three friends agreed they needed to learn more about the glowing fragment and decided to go to the old village library the next day.
                    </p>
                    <p>
                        When morning finally dawned, the three friends were already awake and ready for their adventure. At the library they told the friendly MrsÂ Meier about their discovery. The librarian led them to an old leatherâ€‘bound book and opened a chapter about the legend of the LightÂ Stones. It said that these stones had been created long ago by a wise wizard to protect the world from a dark power and that they had been shattered into several fragments and hidden away. â€œOur fragment could be part of these LightÂ Stones,â€ whispered Finn. Leni nodded thoughtfully. â€œThat would explain why it feels so magical,â€ she said. The three friends decided to follow the mystery and set out to search for the remaining fragments.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <script>
        /*
         * Diese Skriptlogik zerlegt die AbsÃ¤tze des Textes in einzelne Worte,
         * versieht sie mit Datenattributen und erzeugt Vorlesefunktionen. Beim
         * Vorlesen wird jedes gesprochene Wort blau markiert. Beim Stoppen bleibt
         * die Markierung an der zuletzt gelesenen Stelle erhalten, damit der
         * Leser weiÃŸ, wie weit er bereits gekommen ist. Ein Pauseâ€‘Knopf wurde
         * bewusst weggelassen, da die Stoppfunktion denselben Zweck erfÃ¼llt.
         */
        let currentSpeech = null;
        let currentLanguage = 'de';
        let currentWordIndex = 0;
        // Speichert alle Worte separat fÃ¼r jede Sprache
        const allWords = { de: [], en: [] };
        let lastHighlightedWord = null;

        /**
         * Zerlegt die Texte beider Sprachen in einzelne Worte und versieht sie mit
         * entsprechenden Datenattributen. Dadurch kÃ¶nnen die Worte einzeln
         * angesprungen und markiert werden. Die Indizes werden separat pro
         * Sprache gezÃ¤hlt.
         */
        function initializeWords() {
            ['de', 'en'].forEach(lang => {
                allWords[lang] = [];
                const container = document.querySelector(`#${lang}-textContent`);
                // Fallback: in unserer Struktur heisst das Element de-textContent / en-textContent
                const paragraphs = document.querySelectorAll(`#${lang}-textContent p`);
                let wordCounter = 0;
                paragraphs.forEach(paragraph => {
                    const text = paragraph.textContent.trim();
                    const splitWords = text.split(/\s+/).filter(w => w.length > 0);
                    let html = '';
                    splitWords.forEach(word => {
                        html += `<span class="word" data-index="${wordCounter}" onclick="startFromWord(${wordCounter})">${word}</span> `;
                        allWords[lang].push(word);
                        wordCounter++;
                    });
                    paragraph.innerHTML = html.trim();
                });
            });
        }

        /**
         * Setzt die sichtbare Sprache und aktualisiert die Beschriftungen der
         * FunktionsknÃ¶pfe. Beim Umschalten wird das Vorlesen gestoppt und der
         * Fortschritt zurÃ¼ckgesetzt. Die Parameter event werden genutzt, um
         * den aktiven Button korrekt zu markieren.
         */
        function switchLanguage(lang, event) {
            // Stoppe aktuelles Vorlesen
            stopReading();
            // Setze die Sprache
            currentLanguage = lang;
            currentWordIndex = 0;
            // Verstecke alle sprachspezifischen Inhalte
            document.querySelectorAll('.language-content').forEach(elem => elem.classList.add('hidden'));
            // Zeige die ausgewÃ¤hlte Sprache
            document.getElementById(`${lang}-content`).classList.remove('hidden');
            // Aktualisiere die Beschriftung der Buttons
            const labels = {
                de: { play: 'Vorlesen', cont: 'Weiterlesen', stop: 'Stop' },
                en: { play: 'Read', cont: 'Continue', stop: 'Stop' }
            };
            document.getElementById('btn-play').innerHTML = (lang === 'de' ? 'ğŸ”´Â ' : 'ğŸ”´Â ') + labels[lang].play;
            document.getElementById('btn-continue').innerHTML = (lang === 'de' ? 'â–¶ï¸Â ' : 'â–¶ï¸Â ') + labels[lang].cont;
            document.getElementById('btn-stop').innerHTML = (lang === 'de' ? 'â¹ï¸Â ' : 'â¹ï¸Â ') + labels[lang].stop;
            // Setze die aktive Klasse auf die SprachknÃ¶pfe
            document.querySelectorAll('.btn-lang').forEach(btn => btn.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }
            // Scroll zu Beginn des Textes
            const topElem = document.querySelector(`#${lang}-content`);
            if (topElem) {
                topElem.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        /**
         * Markiert das aktuelle Wort. Entfernt vorherige Markierung nur in der
         * aktuellen Sprache.
         */
        function highlightWord(index) {
            // Entferne vorherige Hervorhebung
            if (lastHighlightedWord) {
                lastHighlightedWord.classList.remove('word-highlight');
            }
            const element = document.querySelector(`#${currentLanguage}-content .word[data-index="${index}"]`);
            if (element) {
                element.classList.add('word-highlight');
                lastHighlightedWord = element;
                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        /**
         * Beginnt das Vorlesen von vorne.
         */
        function startReading() {
            currentWordIndex = 0;
            if (currentSpeech) {
                speechSynthesis.cancel();
            }
            continueReading();
        }

        /**
         * Liest den Text ab der aktuellen Position vor und markiert Worte.
         */
        function continueReading() {
            if (currentSpeech) {
                speechSynthesis.cancel();
            }
            const words = allWords[currentLanguage];
            if (words && words.length > currentWordIndex) {
                const remainingText = words.slice(currentWordIndex).join(' ');
                currentSpeech = new SpeechSynthesisUtterance(remainingText);
                currentSpeech.rate = 1.0;
                currentSpeech.lang = currentLanguage === 'de' ? 'de-DE' : 'en-US';
                let localIndex = currentWordIndex;
                currentSpeech.onboundary = function(event) {
                    if (event.name === 'word') {
                        highlightWord(localIndex);
                        localIndex++;
                        currentWordIndex = localIndex;
                    }
                };
                currentSpeech.onend = function() {
                    // am Ende nichts tun
                };
                speechSynthesis.speak(currentSpeech);
            }
        }

        /**
         * Beginnt das Vorlesen an einer bestimmten Position.
         */
        function startFromWord(index) {
            currentWordIndex = index;
            if (currentSpeech) {
                speechSynthesis.cancel();
            }
            continueReading();
        }

        /**
         * Stoppt die Sprachausgabe. Die zuletzt hervorgehobene Position bleibt
         * erhalten, sodass der Leser weiÃŸ, wo er aufgehÃ¶rt hat.
         */
        function stopReading() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
            }
        }

        // Initialisierung, sobald die Seite geladen wurde
        document.addEventListener('DOMContentLoaded', function() {
            initializeWords();
            switchLanguage('de');
        });
    </script>
</body>
</html>
